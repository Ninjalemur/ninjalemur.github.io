<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://ninjalemur.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://ninjalemur.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-01-30T06:39:18+00:00</updated><id>https://ninjalemur.github.io/feed.xml</id><title type="html">Gerard’s Website</title><subtitle>Gerard&apos;s projects and musings </subtitle><entry><title type="html">Google Sheets techniques (Episode 2)</title><link href="https://ninjalemur.github.io/blog/2023/sheets-techniques_002/" rel="alternate" type="text/html" title="Google Sheets techniques (Episode 2)"/><published>2023-05-11T00:33:00+00:00</published><updated>2023-05-11T00:33:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/sheets-techniques_002</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/sheets-techniques_002/"><![CDATA[<h2 id="contents">Contents</h2> <ul id="markdown-toc"> <li><a href="#contents" id="markdown-toc-contents">Contents</a></li> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li> <li><a href="#challenges-of-array-formulas" id="markdown-toc-challenges-of-array-formulas">Challenges of array formulas</a></li> <li><a href="#components-of-map-tab" id="markdown-toc-components-of-map-tab">Components of Map tab</a> <ul> <li><a href="#row-counting" id="markdown-toc-row-counting">Row counting</a></li> <li><a href="#column-checker" id="markdown-toc-column-checker">Column checker</a></li> <li><a href="#creating-a-range-string" id="markdown-toc-creating-a-range-string">Creating a range string</a></li> <li><a href="#nameranges" id="markdown-toc-nameranges">Nameranges</a></li> </ul> </li> <li><a href="#the-map-tab-as-a-map-of-the-data" id="markdown-toc-the-map-tab-as-a-map-of-the-data">The Map tab as a “Map” of the data</a></li> <li><a href="#why-split-the-inventory-into-two-tabs" id="markdown-toc-why-split-the-inventory-into-two-tabs">Why split the Inventory into two tabs?</a></li> <li><a href="#wow-it-seems-like-a-lot-of-work-is-it-worth-it" id="markdown-toc-wow-it-seems-like-a-lot-of-work-is-it-worth-it">Wow, it seems like a lot of work. Is it worth it?</a></li> <li><a href="#how-to-build-upon-the-template" id="markdown-toc-how-to-build-upon-the-template">How to build upon the template</a></li> <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li> </ul> <h2 id="introduction">Introduction</h2> <p>In our previous <a href="www.gerardchan.com/blog/2023/sheets-techniques_001/">episode</a>, we covered some techniques to improve performance and readability for Google Sheets that contain a lot of formulas. One of those techniques was the use of array formulas. However, array formulas do come with their own constraints to manage, and this episode will cover a solution to manage them: the Map tab. Feel free to make a copy the sample use case we’ll be covering from <a href="https://docs.google.com/spreadsheets/d/1WuVGitJQlfCFZmKxCGn5AJar8WfFk8y8pJzQYsZ3svQ">here</a>.</p> <p>In our example use case, we have a spreadsheet that helps compute the total value of an inventory of fruit in local currency. TThe spreadsheet consists of several tabs.</p> <ul> <li>Inventory_Input: The data tab called that will contain data on fruits, with columns for the name of the fruits, the quantity, and the unit price of each fruit in USD</li> <li>Interface: Our user interface tab, which contains a field for users to input a currency exchange number for USD to their local currency, and an output field computing the total value of the fruit inventory in local currency. This output field computes its output based on the data in “Inventory_Input” as well as the exchange rate input from the user</li> <li>CALC_Inventory: A calculation tab which contains calculations</li> <li>MAP: The Map tab, which we will go into more detail later on</li> </ul> <h2 id="challenges-of-array-formulas">Challenges of array formulas</h2> <p>When using array formulas to process data, there are two main ways to refer to the columns that we are using in our computations: full column ranges (eg A:A), or bounded ranges (eg A1:A1000). Each of them have different advantages and drawbacks. Full column ranges have a higher performance overhead, but will dynamically respond to the number of rows changing. Bounded ranges have a lower performance overhead, but by default do not respond dynamically to the number of rows changing.</p> <p>When we have a large spreadsheet with many formulas and columns, it’s important that performance is manageable, and that maintenance is manageable (ie we do not have to manually update many formulas each time the size of the data changes). The Map tab aims to accomplish this.</p> <h2 id="components-of-map-tab">Components of Map tab</h2> <p>The Map tab consists of several key components.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/map_tab-labelled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/map_tab-labelled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/map_tab-labelled-1400.webp"/> <img src="/assets/img/sheets_techniques/map_tab-labelled.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <ol> <li>A row counter that counts the number of rows in a sheet</li> <li>A column checker that returns the column letter of a given column</li> <li>A string that concatenates sheet name, column, and rows to create a range string (eg Sheet1!A1:A10)</li> <li>Nameranges that refer to the ranges strings in the tab</li> </ol> <p>What the map tab is doing is reducing the number of time full column ranges are called in array formulas from “every time a column is referenced” to “once per data tab”. This drastically reduces the performance overhead while retaining the benefit of dynamically responding to varying number of rows. How does it accomplish this via each of the components? Let’s step through each of them to find out.</p> <h3 id="row-counting">Row counting</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=ARRAYFORMULA(
    MAX(
        IF(
            LEN(Inventory_Input!A:A),
            ROW(Inventory_Input!A:A),
            )
        )
    )
</code></pre></div></div> <p>This row counting formula helps to find the maximum row in the input data tab that contains data. The row number returned will then be referenced by other formulas to generate bounded range strings without having to each utilise a full column range reference.</p> <h3 id="column-checker">Column checker</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=REGEXEXTRACT(
    ADDRESS(
        1,
        COLUMN(Inventory_Input!A$1)
        ),
    "[A-Z]+"
    )
</code></pre></div></div> <p>This formula extracts the column letter of a given column. The reason why we formularise this instead of entering a letter like “A” directly is to allow the column reference to shift left or right if we insert or delete columns. For example, if a column was inserted to to left of column A, our example reference above would start returning B instead of A. This implementation helps to reduce the maintenance needed as we expand our spreadsheet.</p> <h3 id="creating-a-range-string">Creating a range string</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>=CONCATENATE(
    "'",
    $B$6,
    "'!",
    B9,
    $B$3,
    ":",
    B9,
    $B$4
    )
</code></pre></div></div> <p>This formula concatenates the sheet name, column letter, and row numbers together into a range string that we can use in formulas. As the number of data rows or the columns change, the row counter and column checkers will update, and update this range string accordingly, allowing us the benefit of increased performance of bounded column ranges for our array formulas, while managing the downside of maintenance overhead.</p> <h3 id="nameranges">Nameranges</h3> <p>As is good practice, we give each of our ranges a name to refer to them by. It’s much easier to understand what INDIRECT(MAP_INVENTORY_QTY) * INDIRECT(MAP_INVENTORY_UNITPRICE_LOCAL) means, compared to INDIRECT(MAP!C10) * INDIRECT(MAP!C17).</p> <h2 id="the-map-tab-as-a-map-of-the-data">The Map tab as a “Map” of the data</h2> <p>The map tab contains all the range strings for all the data in the entire spreadsheet. It provides a central place to look up what data a spreadsheet contains, and where it is located. This is extremely helpful for human readability, not just for making our formulas work. If we wanted to, we could even add a “Description” column where we can describe the contents of each column and turn the Map tab into a data dictionary.</p> <h2 id="why-split-the-inventory-into-two-tabs">Why split the Inventory into two tabs?</h2> <p>The Inventory data is split across two tabs, “Inventory_Input” and “CALC_Inventory”. This is to segregate input data that comes from an external source or the user, from data that is entirely generated by formulas. With this segregation, users can feel comfortable inspecting and correcting data in data tabs, without the stress of working in a tab where some columns are data they can modify, and other columns are formulas that they have to be careful not to break.</p> <p>From a data model standpoint, the two tabs can be considered the same “data frame”. They contain the same number of rows, and the n-th row in “Inventory_Input” refers to the n-th row “CALC_Inventory”. I chose to name the named ranges for columns in both these tabs with the same “MAP_INVENTORY” prefix to convey them as both being part of the Inventory table.</p> <h2 id="wow-it-seems-like-a-lot-of-work-is-it-worth-it">Wow, it seems like a lot of work. Is it worth it?</h2> <p>It depends. For one-off spreadsheets that take less than 15 minutes to build, and that you will almost never look at again, it’s absolutely not worth it to take this much effort to implement a map tab. However, if your spreadsheet takes more than a few hours to build, and it’s something you want to come back to to review or build upon, or you need to hand over to someone else, then it’s absolutely worth it. I’ve used these techniques in a professional setting, and it’s made onboarding new team members and allowing them to build upon existing assets much easier. It’s allowed me to come back to personal projects like the savings calculator two years after last working on it and quickly re-familiarising with it to build an updated version.</p> <p>Remember, code spends 90% of its time being read, 10% of its time being written. Making that 90% easier is a huge benefit.</p> <h2 id="how-to-build-upon-the-template">How to build upon the template</h2> <p>All this setup is to make expanding on the existing spreadsheet easier. But what exactly do you need to do to expand the spreadsheet?</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/map_tab-expand-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/map_tab-expand-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/map_tab-expand-1400.webp"/> <img src="/assets/img/sheets_techniques/map_tab-expand.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>If you wanted to add more columns to the Inventory table, you would add more rows at 1 (pictured above) for data input columns, and more rows at 2 (pictured above) if you wanted to add more calculated columns.</p> <p>If you wanted to add more data tables, you could copy the entire block from A1 to C18, and paste them into new rows below. Remember to update the “data table” name from “Inventory” to your new data table name, the sheet names to your new sheet names, as well as the formula references in all the pale blue cells.</p> <h2 id="conclusion">Conclusion</h2> <p>The Map tab is a setup that can help make large spreadsheets easier to manage, AND speed them up. Spreadsheets are a powerful tool for creating number crunchers that take in user input. Keeping your spreadsheets responsive and easy to maintain will make your work more productive. Don’t forget to apply the techniques learnt here and in our previous <a href="www.gerardchan.com/blog/2023/sheets-techniques_001/">episode</a>!</p>]]></content><author><name></name></author><category term="spreadsheets"/><category term="arrayformulas"/><summary type="html"><![CDATA[Advanced tips for working with Array Formulas]]></summary></entry><entry><title type="html">Google Sheets techniques for performance and readability</title><link href="https://ninjalemur.github.io/blog/2023/sheets-techniques_001/" rel="alternate" type="text/html" title="Google Sheets techniques for performance and readability"/><published>2023-04-27T00:33:00+00:00</published><updated>2023-04-27T00:33:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/sheets-techniques_001</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/sheets-techniques_001/"><![CDATA[<h2 id="contents">Contents</h2> <ul id="markdown-toc"> <li><a href="#contents" id="markdown-toc-contents">Contents</a></li> <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li> <li><a href="#why-google-sheets" id="markdown-toc-why-google-sheets">Why Google Sheets?</a></li> <li><a href="#technique-1-use-array-formulas" id="markdown-toc-technique-1-use-array-formulas">Technique 1: Use Array Formulas</a></li> <li><a href="#technique-2-use-named-ranges" id="markdown-toc-technique-2-use-named-ranges">Technique 2: Use Named Ranges</a></li> <li><a href="#technique-3-formatting-formulas" id="markdown-toc-technique-3-formatting-formulas">Technique 3: Formatting formulas</a></li> <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li> </ul> <h2 id="introduction">Introduction</h2> <p>Google Sheets is a powerful tool that can help with data storage, analysis, and processing. It’s an affordable and accessible tool with a remarkable amount of flexibility. However, as your spreadsheets get more complex, their performance gets noticeably slower and they become more difficult to maintain. In this blog post, we’ll cover some techniques to help you make your Google Sheets faster and easier to maintain.</p> <h2 id="why-google-sheets">Why Google Sheets?</h2> <p>Google Sheets is a great choice for small applications where some data needs to be crunched, and the results shown to the user. It’s very accessible, with no cost required on a free Google Account, no need to download and install any local application, and browser based access making it OS-agnostic. Minimal specialised skills are needed by both spreadsheet creators as well as users to leverage the value of Google Spreadsheets. Sharing spreadsheets with people is as simple as granting them permissions and sending them a link.</p> <h2 id="technique-1-use-array-formulas">Technique 1: Use Array Formulas</h2> <p>Using Arrayformulas instead of many individual formulas can help improve both performance and ease of maintenance of spreadsheets.</p> <p>Arrayformulas can be used by calling the ARRAYFORMULA function and using array ranges instead of individual cell references in the formula.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/arrayformula-basic-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/arrayformula-basic-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/arrayformula-basic-1400.webp"/> <img src="/assets/img/sheets_techniques/arrayformula-basic.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>In many use cases, data will be in a tabular format, with data in a column referencing other data in the same row but in different columns. One common practice is to create the formula for the first row of data, and then copy or drag that formula to every other row in the column. This results in a large number of cells containing formulas, increasing the performance overhead. Maintainability also suffers, with there needing to be checks to ensure that all formulas in a column are appropriately update and aligned.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_individual-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_individual-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_individual-1400.webp"/> <img src="/assets/img/sheets_techniques/arrayformulas-example_individual.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_array-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_array-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/arrayformulas-example_array-1400.webp"/> <img src="/assets/img/sheets_techniques/arrayformulas-example_array.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption"> Arrayformulas can reduce the number of cells containing formulas, improving performance and ease of maintenance. </div> <p>Using array formulas addresses both performance and maintainability concerns. Array formulas incur a noticeably lower performance overhead than columns full of individual formulas. Maintenance is also easier, with only one formula per column needing to be updated and edited.</p> <p>Template spreadsheets are available to demonstrate the performance difference. The template for individual formulas is <a href="https://docs.google.com/spreadsheets/d/16osGUoORJPfiaCFRObAnLXiLa0v5B2P5ZfSsJsblNM0">here</a> and the one for array formulas is <a href="https://docs.google.com/spreadsheets/d/1TddxYJaXkQr9k_5sykZyu1qsr4NJaN4WyYEyf_Hn1GA">here</a>. Do make your own copies, then try changing the input in the yellow cell and timing how long it takes for the output in the green cell to be updated.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/arrayformula-speed_demo_input_output-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/arrayformula-speed_demo_input_output-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/arrayformula-speed_demo_input_output-1400.webp"/> <img src="/assets/img/sheets_techniques/arrayformula-speed_demo_input_output.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <h2 id="technique-2-use-named-ranges">Technique 2: Use Named Ranges</h2> <p>Use Named ranges where possible instead of cell references (eg FRUITS_QTY instead of ‘Fruits Named Ranges’!C2:C5). This makes formulas much easier to read and understand, drastically boosting readability.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/named_ranges_menu-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/named_ranges_menu-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/named_ranges_menu-1400.webp"/> <img src="/assets/img/sheets_techniques/named_ranges_menu.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>The Named Ranges menu can be accessed by going to Data &gt; Named Ranges, bringing up an interface to input names and ranges that the names should correspond to.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/named_ranges_interface-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/named_ranges_interface-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/named_ranges_interface-1400.webp"/> <img src="/assets/img/sheets_techniques/named_ranges_interface.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>Once created, Named Ranges can be referred to in formulas by their name.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/arrayformula-formula_use-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/arrayformula-formula_use-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/arrayformula-formula_use-1400.webp"/> <img src="/assets/img/sheets_techniques/arrayformula-formula_use.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <h2 id="technique-3-formatting-formulas">Technique 3: Formatting formulas</h2> <p>Formatting formulas with newlines and indents is another practice that helps to improve the readability and maintainability of spreadsheets.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/formula_noformat-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/formula_noformat-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/formula_noformat-1400.webp"/> <img src="/assets/img/sheets_techniques/formula_noformat.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sheets_techniques/formula_format-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sheets_techniques/formula_format-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sheets_techniques/formula_format-1400.webp"/> <img src="/assets/img/sheets_techniques/formula_format.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption"> Formatting makes formulas easier to read </div> <p>My recommended formatting convention involves having arguments to a formula be one indent to the right of the formula, with each argument on a new line. This makes it easy to quickly identify what the arguments to any given function are, as well as which function an argument is for.</p> <h2 id="conclusion">Conclusion</h2> <p>By following these techniques, you can improve the performance of your Google Sheets and make them easier to maintain. Remember to prioritize performance and readability, and use array formulas, named ranges, and formatting. We hope you found these tips helpful and wish you the best of luck in managing your spreadsheets!</p>]]></content><author><name></name></author><category term="spreadsheets"/><summary type="html"><![CDATA[Make your Google Sheets faster and easier to maintain with these tips]]></summary></entry><entry><title type="html">Food Dashboard is live!</title><link href="https://ninjalemur.github.io/blog/2023/food-dashboard_001/" rel="alternate" type="text/html" title="Food Dashboard is live!"/><published>2023-04-20T00:33:00+00:00</published><updated>2023-04-20T00:33:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/food-dashboard_001</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/food-dashboard_001/"><![CDATA[<p>Do check out the <a href="https://www.gerardchan.com/projects/food_dashboard/">Food Dashboard project page</a> for the link to the dashboard as well as how to use it!</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/food_dashboard/food_dashboard-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/food_dashboard/food_dashboard-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/food_dashboard/food_dashboard-1400.webp"/> <img src="/assets/img/food_dashboard/food_dashboard.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <h2 id="how-the-food-dashboard-came-about">How the Food Dashboard came about</h2> <p>Enjoying good food with friends is a significant part of life. We’ve all had great food at many places over time, but it’s so hard to remember places on demand. I first tried to create a list of places to eat in SimpleNote, but that was not very conducive to searching based on common criteria that we had, such as price point, cuisine, and location.</p> <p>The next iteration of my food reference took the form of this Tableau Dashboard. With Tableau we can easily filter places to eat based on criteria such as price, point, cuisine, and location much more easily.Users can also visualise the places on a map, and see which places are nearby. Publishing this dashboard on Tableau public made it easy to share with friends and reference on the go.</p> <p>This dashboard has certaintly sparked joy for me, and I hope it sparks joy for you too. Do check out the<a href="https://www.gerardchan.com/projects/food_dashboard/">Food Dashboard project page</a> for the dashboard link and some directions on how to use the dashboard!</p>]]></content><author><name></name></author><category term="dashboard"/><category term="food"/><category term="tableau"/><summary type="html"><![CDATA[Use this dashboard to help you decide where to eat next!]]></summary></entry><entry><title type="html">Food Sharing Template is live!</title><link href="https://ninjalemur.github.io/blog/2023/food-sharing-template_001/" rel="alternate" type="text/html" title="Food Sharing Template is live!"/><published>2023-04-13T00:33:00+00:00</published><updated>2023-04-13T00:33:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/food-sharing-template_001</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/food-sharing-template_001/"><![CDATA[<p>Do check out the <a href="https://www.gerardchan.com/projects/food_sharing_template/">Food Sharing Template project page</a> for a copy of the spreadsheet as well as instructions on how to use it!</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/food_share/food_sharing_template-food_drinks-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/food_share/food_sharing_template-food_drinks-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/food_share/food_sharing_template-food_drinks-1400.webp"/> <img src="/assets/img/food_share/food_sharing_template-food_drinks.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <div class="caption"> Places, dishes, and people in the image above are fictitious. Any resemblance to places, dishes, or people is entirely coincidental. If Jim and Sally were real, definitely follow them on social media. People who go through a chocolate fountain, two tequila towers, and pork cracklings all in a single sitting are worth having in your feed. </div> <h2 id="why-this-spreadsheet">Why this spreadsheet</h2> <p>I created the Food Sharing Template to help split the bill when eating out with friends. You know how it can be a real pain - one person pays for everything, then we all have to remember what we ordered and calculate how much to pay them back. It gets even more troublesome when there are taxes, shared dishes, some people order more than others, and some dishes are only shared between a few people. So, I created this handy spreadsheet where we can input our individual orders and shared dishes, and it automatically calculates the shared cost. This has really cut down the effort of splitting bills, and provides a handy table for everyone to check that the bill was split correctly.</p> <p>I hope it helps you as much as it has helped my friends and I!</p>]]></content><author><name></name></author><category term="spreadsheets"/><category term="food"/><summary type="html"><![CDATA[Split meal costs easily with friends using this spreadsheet!]]></summary></entry><entry><title type="html">Warhammer 40k 9th Edition Attack Simulator Spreadsheet v 0.1 is live!</title><link href="https://ninjalemur.github.io/blog/2023/wh40k_asim_sheet_001_v01_live/" rel="alternate" type="text/html" title="Warhammer 40k 9th Edition Attack Simulator Spreadsheet v 0.1 is live!"/><published>2023-04-06T00:33:00+00:00</published><updated>2023-04-06T00:33:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/wh40k_asim_sheet_001_v01_live</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/wh40k_asim_sheet_001_v01_live/"><![CDATA[<h2 id="contents">Contents</h2> <ul id="markdown-toc"> <li><a href="#contents" id="markdown-toc-contents">Contents</a></li> <li><a href="#overview" id="markdown-toc-overview">Overview</a></li> <li><a href="#what-is-warhammer-40k" id="markdown-toc-what-is-warhammer-40k">What is Warhammer 40k?</a></li> <li><a href="#objective-of-creating-my-spreadsheet" id="markdown-toc-objective-of-creating-my-spreadsheet">Objective of creating my spreadsheet</a> <ul> <li><a href="#goal-increase-ease-of-maintenance" id="markdown-toc-goal-increase-ease-of-maintenance">Goal: Increase ease of maintenance</a></li> <li><a href="#goal-lower-the-effort-needed-to-create-new-use-cases" id="markdown-toc-goal-lower-the-effort-needed-to-create-new-use-cases">Goal: Lower the effort needed to create new use cases</a></li> </ul> </li> <li><a href="#design-choices" id="markdown-toc-design-choices">Design Choices</a> <ul> <li><a href="#separate-the-front-end-user-interface-from-the-back-end-calculations" id="markdown-toc-separate-the-front-end-user-interface-from-the-back-end-calculations">Separate the front-end user interface from the back-end calculations</a></li> <li><a href="#use-arrayformula-for-calculations" id="markdown-toc-use-arrayformula-for-calculations">Use ARRAYFORMULA for calculations</a></li> <li><a href="#consolidate-keywords-in-a-single-tab" id="markdown-toc-consolidate-keywords-in-a-single-tab">Consolidate Keywords in a single tab</a></li> <li><a href="#use-named-ranges-for-column-names" id="markdown-toc-use-named-ranges-for-column-names">Use Named Ranges for column names</a></li> <li><a href="#use-battlescribe-data-as-a-data-source" id="markdown-toc-use-battlescribe-data-as-a-data-source">Use BattleScribe data as a data source</a></li> </ul> </li> <li><a href="#use-cases" id="markdown-toc-use-cases">Use cases</a> <ul> <li><a href="#single-attacker-split-fire" id="markdown-toc-single-attacker-split-fire">Single Attacker split fire</a></li> <li><a href="#individual-attackers-vs-defender" id="markdown-toc-individual-attackers-vs-defender">Individual Attackers vs Defender</a></li> <li><a href="#mixed-squad-vs-individual-defenders" id="markdown-toc-mixed-squad-vs-individual-defenders">Mixed Squad vs Individual Defenders</a></li> </ul> </li> <li><a href="#whats-next" id="markdown-toc-whats-next">What’s next?</a></li> </ul> <h2 id="overview">Overview</h2> <p>The first version of my Warhammer 40k Attack simulator spreadsheet is available. It allows users to compute the points efficiency of attackers against defenders in the tabletop game Warhammer 40,000. Do make a copy from <a href="https://www.gerardchan.com/projects/wh40k_9ed_attack_sim_sheet/">here</a>, and feel free to share your thoughts in the feedback form! The new 10th edition of the game will launch in the coming months, and I look forward to updating the spreadsheet to accommodate the new set of rules then!</p> <h2 id="what-is-warhammer-40k">What is Warhammer 40k?</h2> <p>Warhammer 40k is a tabletop miniatures wargame published by <a href="https://www.games-workshop.com/">Games Workshop</a>. Players battle on a tabletop using their own armies of painted miniatures. Distances for movement and weapon ranges are physically measured using a measuring tape, and combat is resolved via dice in a process known as the attack sequence. Unlike Risk, units are not all made equal. Different units have different statistics, strengths, and weaknesses which influence their chances of success when the dice are rolled.</p> <p>I’ve always found the strategic depth of Warhammer 40k fascinating. Players can choose from a variety of factions to build their armies with. Each faction has a whole roster of different units to select from, and each unit can often be further customised with different wargear and weapon selections. Before the start of the battle, players have to choose where on the battlefield they wish to deploy their units, or even hold them in reserve for deployment midway through the battle. During the battle, where units are moved and what enemies they choose to attack is a huge determining factor in how much value they will deliver during the battle.</p> <p>For the longest time, I hadn’t really gotten into Warhammer 40k due to some barriers to entry. The time committment required was huge, with models needing to be painted before play, and games running on average between 3 to 4 hours. Cost was also not trivial, with an army of models usually costing a few hundred dollars (or more if you wanted to change up your roster now and then), and rulebooks usually costing $50 per faction.</p> <p>Recently, I discovered <a href="https://www.tabletopsimulator.com/">Tabletop Simulator</a>, a PC game which can simulate a variety of games from chess, to mahjong, and with the help of some <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=775431044">Steam Workshop Mods</a>, Warhammer 40k. This brings the cost of entry down significantly, saves me the trouble of painting, storing, and transporting miniatures, and provides some of the quality of life that the electronic medium can provide, such as electronically spawning large numbers of dice and tallying up the rolls automatically. I’m definitely looking forward to playing the game in this medium.</p> <h2 id="objective-of-creating-my-spreadsheet">Objective of creating my spreadsheet</h2> <p>The inspiration for my spreadsheet was from a version shared by figrin1 on <a href="https://www.reddit.com/r/WarhammerCompetitive/comments/i6ubf9/ultracomprehensive_and_pretty_updated_mathhammer/">Reddit</a>. It provides a user interface and calculations to answer the question of “If this attacker attacks this defender, how many points of damage did the attacker deal relative to its own points cost?” The spreadsheet allows a user to select an attacker, up to three weapons for the attacker, and a defender.</p> <p>After using his spreadsheet for a while, I was inspired to build my own to improve on the original in two key areas</p> <ol> <li>Increase ease of maintenance and expandability</li> <li>Lower the effort needed to create new use cases</li> </ol> <p>In order to achieve those goals, I implemented a number of design choices</p> <ol> <li>Separate the front-end user interface from the back-end calculations</li> <li>Use ARRAYFORMULA for calculations</li> <li>Consolidate Keywords (eg “Rapid Fire”) in a single tab</li> <li>Use Named Ranges for column names</li> <li>Use <a href="https://github.com/BSData/wh40k">BattleScribe data</a> as a data source</li> </ol> <h3 id="goal-increase-ease-of-maintenance">Goal: Increase ease of maintenance</h3> <p>Attack Math in Warhammer 40k takes in a large number of inputs, ranging from Strength of attacks, to Skill, to armour and toughness of the defender. While deconstructing the original spreadsheet, it was taking me a long time to figure out what each cell reference in each formula meant. I would have to look up references like “C4” or “E20” and then go back to reading the original formula. This made it slow and error prone for me to read what the formulas were doing, and implement changes in an efficient and sustainable way.</p> <p>In addition, if a new rule was implemented, I would need to manually implement that rule in every attack sequence in the spreadsheet. The original spreadsheet had a single attacker with 3 weapons attacking a single defender for a total of 3 attack sequences. I wanted to be able to handle everything from 11 weapons per attacker, to multiple attackers and defenders. Having to adjust formulas for each and every attack sequence individually was not an option.</p> <h3 id="goal-lower-the-effort-needed-to-create-new-use-cases">Goal: Lower the effort needed to create new use cases</h3> <p>When attempting to expand upon the original spreadsheet that I made a copy of, each sequence of attacks against the defender were coded on a cell by cell basis in an arrangement that didn’t allow for easy copying or dragging of the formulas to create more attack sequence calculations. This made it challenging for me to expand the use case to questions like like “what about if and attacker with 11 weapons shoots a defender” or “which of these 3 attackers is most efficient against this defender?”</p> <p>My goal for new use cases was for it to be as simple as collecting user inputs on the attacker and defender details, and then displaying the results of the attack sequences, without having to manage the calcluations themselves each time.</p> <h2 id="design-choices">Design Choices</h2> <p>The various design choices made were done with the intention of achieving the goals of increasing ease of maintenance, as well as lowering the effort of creating new use cases.</p> <h3 id="separate-the-front-end-user-interface-from-the-back-end-calculations">Separate the front-end user interface from the back-end calculations</h3> <p>The front end user input and visualisation area was separated from the back end calculation area. The front end that the user interacts with serves as the area where they can make their inputs and view the results, but don’t have to be overwhelmed or bombarded with the myriad of calculations that are done behind the scenes. Each front end can also be tailored specifically to meet the needs of specific use cases, and function independently of each other.</p> <p>Consolidating all the calculations into the various back ends (dmg_calc and morale_calc) allowed a single point of implementation for each rule relating to attack sequences or morale. This would make it easier to maintain. Additionally, the back end is designed to accept a number of inputs in a specific structure (eg attacker strength, defender toughness etc) and generate outputs in a specific structure (number of models lost to damage etc). New use cases that are created simply need to submit their inputs into the relevant column structure on a particular row, and “pick up” their outputs in the respective columns of that same row. This drastically lowers the effort needed to implement use cases, as the calculations for attack sequences and morale are essentially “write once, call many times”.</p> <h3 id="use-arrayformula-for-calculations">Use ARRAYFORMULA for calculations</h3> <p>The ARRAYFORMULA function in Google sheets allows me to reference various columns in a table at once, and display the outputs in a new column. This obviates the need to drag formulas down through the rest of each column, preventing the possible error of forgetting to drag formulas, as well as providing a performance boost relative to having an individual formula in each row of the column. This drastically increases maintainability.</p> <h3 id="consolidate-keywords-in-a-single-tab">Consolidate Keywords in a single tab</h3> <p>Weapon keywords such as “Rapid Fire”, “Melee” and many others are all consolidated in a single tab called “Index”, instead of having their strings written directly in formulas. This provides a central reference to review and maintain. If the wording of an ability or keyword is changed by Games Workshop, I can change the keyword here, rather than in every single formula that references it. This too makes the spreadsheet much easier to maintain.</p> <h3 id="use-named-ranges-for-column-names">Use Named Ranges for column names</h3> <p>I made liberal use of the Google Sheets Named Ranges feature, which allows you to name a range, and subsequently refer to that range via its name instead of cell reference. For example, if “Weapon Strength” is in Sheet1 Column A, I could name Sheet 1 Column A “WEAPON_STRENGTH”. This would allow me to refer to the column as “WEAPON_STRENGTH” rather than “Sheet1!A:A”. This makes formulas much more readable, and the spreadsheet easier to maintain.</p> <h3 id="use-battlescribe-data-as-a-data-source">Use BattleScribe data as a data source</h3> <p>BattleScribe is an app that allows for list building in various games such as Warhammer 40k. The list building rules and options (eg units, weapons etc) are community maintained and publicly available. Leveraging this community maintained data source would allow me to keep the spreadsheet up to date with changes to the points cost of units, or release of new units much more easily. This would drastically improve maintainability of the spreadsheet.</p> <p>At present, I have only partially extracted weapon and unit profiles from the <a href="https://github.com/BSData/wh40k">BattleScribe data</a>. Developing this further is an ongoing project for me.</p> <h2 id="use-cases">Use cases</h2> <p>The Calculator has several use cases, each of which is designed to address various questions that are often asked during the process of building an army list.</p> <h3 id="single-attacker-split-fire">Single Attacker split fire</h3> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/single_attacker_split_fire-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/single_attacker_split_fire-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/single_attacker_split_fire-1400.webp"/> <img src="/assets/img/wh40k_9ed_attack_sim_sheet/single_attacker_split_fire.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>This use case attempts to answer the question “If I have this unit with a lot of guns, and I split its fire between these defenders, what is the points efficiency of this attacker?” Users can select a single attacker and up to eleven weapons to fire at each of up to two defenders. From my experience, units rarely have more than eleven weapons, but do commonly have more than three as provided in the original spreadsheet. With the ease of calculating as many attack sequences as needed, it was easy for me to allow for eleven weapons instead of three.</p> <h3 id="individual-attackers-vs-defender">Individual Attackers vs Defender</h3> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/individual_attackers_vs_defender-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/individual_attackers_vs_defender-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/individual_attackers_vs_defender-1400.webp"/> <img src="/assets/img/wh40k_9ed_attack_sim_sheet/individual_attackers_vs_defender.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>This tab allows a user to select up to three attackers and a defender. The points efficiency of each individual attacker against the defender is displayed in the charts at the top of the page.</p> <p>After fleshing out the Single Attacker split fire tab, I found myself frequently switching between multiple attackers and their weapon loadouts to see which would be the most efficient against a given defender. This was essentially the question of “which of these attackers is most efficient against this defender?”, which is a question that could directly be addressed by this use case. With this use case, the effectiveness of multiple attackers against the defender can be visualised side by side for easy comparison.</p> <h3 id="mixed-squad-vs-individual-defenders">Mixed Squad vs Individual Defenders</h3> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/mixed_squad_vs_individual_defenders_numbered-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/mixed_squad_vs_individual_defenders_numbered-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/wh40k_9ed_attack_sim_sheet/mixed_squad_vs_individual_defenders_numbered-1400.webp"/> <img src="/assets/img/wh40k_9ed_attack_sim_sheet/mixed_squad_vs_individual_defenders_numbered.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>This tab in the spreadsheet allows users to configure a squad consisting of up to three different model types, and up to three different defenders. Charts at the top show how efficient the attacker squad is against each individual defender.</p> <p>Often, after selecting a unit from the previous use case that I was keen to include in my army, I would be concerned how versatile this unit would be against multiple defender profiles. What if I brough an anti-tank specialist that was stellar against tanks, but my opponent didn’t bring tanks? How would this unit fare against infantry or heavy infantry instead? This use case allows users the ability to assess the effiency of an attacker against several individual defenders simulataneously.</p> <p>In addition, many squads in the game usually have a “leader” unit such as a sergeant or an exarch, who has a slightly superior stat profile, and possibly a different weapon or equipment loadout. Allowing the user to configure an attacking squad as mixed (ie comprising of different models) would allow for more accurate assessment of the squad as a whole.</p> <h2 id="whats-next">What’s next?</h2> <p>I’ve had a lot of fun creating this spreadsheet and using it to help me answer various questions of effectiveness and efficiency during the army list building process. Currently, I am working on a python script to get a complete extract of the various unit and weapon profiles from the BattleScribe data. This will provide me a means to update the spreadsheet regularly with comprehensive data.</p> <p>An upcoming project I am looking to undertake is a more programmatic calculation that pits every possible attacker against every possible defender, taking into account various possible loadouts and buff combinations. The results will be visualised in a public Tableau dashboard, where users can apply filters on attackers and defenders for dimensions such as faction, or presence/absence of a specific buff. I’m aware that a new edition is just around the corner, and that rules could drastically change within the next few months. Still, I do expect certain aspects of what I build in the current 9th edition to be reusable in 10th edition, such as the structure of BattleScribe data, and the general mechanics of the attack sequence.</p> <p>I hope you enjoyed reading this content as much as I enjoyed creating it! Do check out the spreadsheet <a href="https://www.gerardchan.com/projects/wh40k_9ed_attack_sim_sheet/">here</a> and share your feedback on what you’d like to see more of in the future!</p>]]></content><author><name></name></author><category term="financial"/><category term="spreadsheets"/><summary type="html"><![CDATA[Key Features and design choices of the 40k attack simulator spreadsheet]]></summary></entry><entry><title type="html">Retirement Savings Calculator v 2.4 is live!</title><link href="https://ninjalemur.github.io/blog/2023/savings-calculator_001_v24_live/" rel="alternate" type="text/html" title="Retirement Savings Calculator v 2.4 is live!"/><published>2023-03-29T09:03:00+00:00</published><updated>2023-03-29T09:03:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/savings-calculator_001_v24_live</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/savings-calculator_001_v24_live/"><![CDATA[<p>The Retirement Savings Calculator Spreadsheet is a tool designed to help individuals calculate how much they can save and accumulate based on different levels of savings and expenditures. As of 29 March 2023, the latest version of the tool is v2.4, and is publicly available <a href="https://docs.google.com/spreadsheets/d/1wKXRlBWTYL16pFi9IdsrThDQC5q2jKmeqlKNkPufefI">here</a>.</p> <p>Do make your own copy for yourself via “File” &gt; “Make a copy”.</p> <p>Do share your feedback on the calculator via the <a href="https://docs.google.com/forms/d/e/1FAIpQLScswYDxLhregN4xUfROgkLVpPJItCGwtvXNHUHqep_RTe5lrw/viewform?usp=sharing">feedback form</a>.</p> <h2 id="contents">Contents</h2> <ul id="markdown-toc"> <li><a href="#contents" id="markdown-toc-contents">Contents</a></li> <li><a href="#overview" id="markdown-toc-overview">Overview</a></li> <li><a href="#how-it-started" id="markdown-toc-how-it-started">How it started</a></li> <li><a href="#context" id="markdown-toc-context">Context</a> <ul> <li><a href="#singapore-personal-income-tax-brackets" id="markdown-toc-singapore-personal-income-tax-brackets">Singapore Personal Income Tax Brackets</a></li> <li><a href="#singapore-has-no-capital-gains-tax" id="markdown-toc-singapore-has-no-capital-gains-tax">Singapore has no Capital Gains Tax</a></li> <li><a href="#cpf-life" id="markdown-toc-cpf-life">CPF Life</a></li> <li><a href="#no-customisable-big-purchases" id="markdown-toc-no-customisable-big-purchases">No customisable big purchases</a></li> </ul> </li> <li><a href="#how-the-spreadsheet-works" id="markdown-toc-how-the-spreadsheet-works">How the spreadsheet works</a> <ul> <li><a href="#before-retirement" id="markdown-toc-before-retirement">Before Retirement</a></li> <li><a href="#after-retirement" id="markdown-toc-after-retirement">After Retirement</a></li> </ul> </li> <li><a href="#features" id="markdown-toc-features">Features</a> <ul> <li><a href="#savings-strategy-savings-committments" id="markdown-toc-savings-strategy-savings-committments">Savings Strategy: Savings committments</a></li> <li><a href="#savings-strategy-free-cash" id="markdown-toc-savings-strategy-free-cash">Savings Strategy: Free Cash</a></li> <li><a href="#cpf-life-1" id="markdown-toc-cpf-life-1">CPF Life</a></li> <li><a href="#chart-savings-value" id="markdown-toc-chart-savings-value">Chart: Savings Value</a></li> <li><a href="#chart-withdrawal-rate" id="markdown-toc-chart-withdrawal-rate">Chart: Withdrawal Rate</a></li> </ul> </li> <li><a href="#what-the-retirement-savings-calculator-does-not-do" id="markdown-toc-what-the-retirement-savings-calculator-does-not-do">What the Retirement Savings Calculator does not do</a></li> <li><a href="#what-next" id="markdown-toc-what-next">What Next?</a></li> <li><a href="#thank-you" id="markdown-toc-thank-you">Thank you!</a></li> </ul> <h2 id="overview">Overview</h2> <p>I’ve created a <a href="https://docs.google.com/spreadsheets/d/1wKXRlBWTYL16pFi9IdsrThDQC5q2jKmeqlKNkPufefI">Retirement Savings calculator</a> in Google Sheets that I use to help me plan out how to save for retirement. This post will be talking more about my rationale and thoughts behind the creation of the calculator, and not so much of a guide to using the calculator. If you are looking for a usage guide, <a href="https://www.gerardchan.com/projects/savings_calculator">this</a> is the page you seek.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/savings_calc/savings_calc_plan-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/savings_calc/savings_calc_plan-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/savings_calc/savings_calc_plan-1400.webp"/> <img src="/assets/img/savings_calc/savings_calc_plan.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <h2 id="how-it-started">How it started</h2> <p>When I first started working, I was faced with the decision of how much of my income should I save in order to have enough for retirement. Understandably, that question can’t be answered without asking other questions like “When do I plan to retire?” or “How much do I need to retire?”.</p> <p>This evolved into creating an ad hoc spreadsheet to key in dates from now till the year I wanted to retire, my projected income, pre- and post-retirement expenses, and projecting the amount of savings I would have over time. I got an answer, and more questions came to mind. What if inflation is higher? What if I cut my expenses by this much? What if I retired this much later? There were so many formulas to tweak, so many values to change, and it was so much work to answer the questions I was asking.</p> <p>This led me to think more clearly about</p> <ul> <li>what key variables I wanted to vary each iteration during planning</li> <li>what were the key outputs I was interested in</li> <li>what calculations needed to be done, but didn’t require me to review the outputs every single time input variables changed</li> </ul> <p>The result was the first Retirement Savings Calculator. Over the years, I’ve added more features, such as CPF Life, income tax calculations, cash buffer, and couple planning. I’m not at the point where I feel “I’ve solved my retirement plan!”, but I’ve got a better understanding of the steps I need to take to hit achieve my retirement goals.</p> <h2 id="context">Context</h2> <p>The Retirement Savings Calculator is tailored to handle a fairly simple context, as far as financial planning goes. Below are some aspects of that context, and their implications.</p> <h3 id="singapore-personal-income-tax-brackets">Singapore Personal Income Tax Brackets</h3> <p>The calculator only computes tax amounts based on Singapore Personal Income Tax Brackets. Singapore has one of the most straightforward progressive tax rules, and so this was something that I felt confident I could write spreadsheet formulas to handle.</p> <h3 id="singapore-has-no-capital-gains-tax">Singapore has no Capital Gains Tax</h3> <p>As Singapore has no Capital Gains Tax, selling from one’s portfolio yields the full value as cash without any complex tax overheads.</p> <h3 id="cpf-life">CPF Life</h3> <p>CPF is Singapore’s mandatory savings and pension plan, with CPF Life as its related annuity. The impact that it has on retirement planning is significant, and I couldn’t omit it without throwing my numbers way off.</p> <h3 id="no-customisable-big-purchases">No customisable big purchases</h3> <p>The spreadsheet doesn’t allow for a way to enter custom big purchases or spends at or over various periods of time. For example, some people might set aside a certain amount of money for the next 5 years to save up for a wedding, or a car, or a house downpayment, after which that expense ceases. How to implement the calculations as well as a user friendly input mechanism for this in a spreadsheet is a challenge I haven’t solved, yet. At this level of complexity, I think a web application with a proper front-end and database would be more suitable than a spreadsheet.</p> <h2 id="how-the-spreadsheet-works">How the spreadsheet works</h2> <h3 id="before-retirement">Before Retirement</h3> <ul> <li>Savings are accumulated in a portfolio, with allocation percetanges and yield set by the user.</li> <li>Savings amounts each year are calculated based on the chosen strategy (Free Cash vs Savings Committment).</li> <li>CPF is accumulated based on salary.</li> </ul> <h3 id="after-retirement">After Retirement</h3> <ul> <li>3 years of savings are withdrawn and held as cash. This provides a cash buffer to draw from during market downturns to reduce the need to sell stocks and bonds at a loss.</li> <li>Each year, the inflation-adjusted amount needed to support retirement expenses is withdrawn from the portfolio.</li> <li>Once a person reaches the age where CPF Life can start paying out (currently 65 as of 2023), they receive CPF Life payouts, and portfolio withdrawals are reduced by this amount</li> <li>Retirees draw from their portfolio until their end of life.</li> </ul> <h2 id="features">Features</h2> <p>One of the major motivations for guiding what features to implement and how to implement them was my desire to be able to specify my plan in a few paramaters, rather than having to do a year-by-year play for items like savings and expenditure. This has resulted in a design where you can key the input parameters fairly succinctly on the input page, and then receive the graphical outputs to assess the outcome of your parameters.</p> <h3 id="savings-strategy-savings-committments">Savings Strategy: Savings committments</h3> <p>The Savings Commitments strategy is one of two savings strategies available for users to select from. With this feature, users can set a monthly or annual savings goal and increment it by a flat amount or percentage each year. This strategy is suited to users who want to prioritise their savings first, and then spend what’s left over.</p> <p>This was the original savings strategy in the first version of the spreadsheet. The question of “If I saved this much each month, is that enough for me retire?” was what spurred me to create the Retirement Savings Calculator, and this savings strategy was the first one I wanted to asses as part of my possible plan.</p> <h3 id="savings-strategy-free-cash">Savings Strategy: Free Cash</h3> <p>When my salary started increasing, I wanted to increase my savings rate while keeping my expenses constant aside from inflation adjustments. The Savings Commitments strategy didn’t quite enable me to capture this succinctly. From this need, the Free Cash strategy was designed. It enabled me to set my expenses and adjust them based on inflation, and set my salary and increment it annually based on what I felt I would be able to attain as an average increment.</p> <h3 id="cpf-life-1">CPF Life</h3> <p>CPF Life provides an extremely cost efficient means of securing a guaranteed lifelong income. From my comparisons to other commercially available annuities, it simply offers a much higher guaranteed return, with the limitation of your premium being subject to a cap. The cap will allow you to have a reasonable income to survive on and be self sufficient, but not support more luxurious spending. If you are looking to have at least a middle class income in retirement, you will still need additional sources of income in retirement.</p> <p>If you have access to CPF Life, it will likely form an excellent base for your retirement income, upon which you can build upon towards your target retirement income level.</p> <p>For the spreadsheet calculator, I have chosen to have CPF Life start paying out on the Standard Plan at the earliest possible age. Based on my calculations, the Escalating plan and the increased monthly payout from the deferred payout start date simply took too long to break even, usually in your late 80s. For simplicity’s sake, I decided to focus on implementing the plan that would be the most supportive of generating income to support retirement: Standard Plan with no deferred payout start.</p> <h3 id="chart-savings-value">Chart: Savings Value</h3> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/savings_calc/savings_calc_savings_value-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/savings_calc/savings_calc_savings_value-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/savings_calc/savings_calc_savings_value-1400.webp"/> <img src="/assets/img/savings_calc/savings_calc_savings_value.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>This is the chart that I initially built to monitor the value of the portfolio over time, both before and after retirement. If the upward growth of the chart slows or reverses, it signals that portfolio growth is not keeping up with inflation-adjusted retirement spending. The chart also gives a sense of the magnitude of the problem, and how soon it occurs. Does the current plan start running out of money in the last few years of life? Or does it run out of money just after retirement?</p> <p>I did find the chart useful for detecting major issues in my retirement plan, but I did find that it was challenging to notice the slowdown in growth, especially later in retirement when absolute numbers are much larger. How would I be able to detect such signs earlier? This would be important in hedging against the risk of living longer than the planned age.</p> <h3 id="chart-withdrawal-rate">Chart: Withdrawal Rate</h3> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/savings_calc/savings_calc_withdrawal_rate-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/savings_calc/savings_calc_withdrawal_rate-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/savings_calc/savings_calc_withdrawal_rate-1400.webp"/> <img src="/assets/img/savings_calc/savings_calc_withdrawal_rate.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <p>In order to better detect signs of the portfolio not being able to keep up with inflation adjusted retirement savings, the withdrawal rate chart was created. The withdrawal rate indicates what percentage of the portfolio is withdrwan in a given year. A 4% withdrawal rate in a given year means 4% of the portfolio was withdrawn that year. A rising withdrawal rate would indicate the portfolio losing ground against inflation adjusted retirement spending, as well as by how much.</p> <p>From my experimentation, I’ve found that withdrawal rates above 5% are usually unsustainable unless one is more optimistic about future market returns than I am. Based on my own preferences, I intend to save up enough for retirement such that my withdrawal rate doesn’t need to increase over time to support my retirement spending. This also gives me a comfortable amount of buffer room when (not if but when) there is a market downturn during retirement.</p> <h2 id="what-the-retirement-savings-calculator-does-not-do">What the Retirement Savings Calculator does not do</h2> <ul> <li><strong>Compute Capital Gains Taxes</strong>: Singapore doesn’t have this (as of 2023).</li> <li><strong>Compute income tax values for countries other than Singapore</strong>: Those are far more complex, and not within my current use case.</li> <li><strong>Handle dynamic costs over time (kids, college, caring for elderly)</strong>: I haven’t found a way to implement these in spreadsheets in a way that is not too onerous or complex for users to understand and key in inputs.</li> <li><strong>Tell you what portfolio allocation is best</strong>: This is a whole topic in and of itself, and not in the scope of the spreadsheet.</li> <li><strong>Tell you what rate of return the market will give at any point in time</strong>: If there’s a spreadsheet that can do this, this isn’t that spreadsheet.</li> <li><strong>Tell you what stocks/bonds/property/commodities to buy</strong>: Like portfolio allocation, that’s a whole topic beyond the scope of the spreadsheet</li> <li><strong>Help you estimate your income or expenses</strong>: That’s beyond the scope of this spreadsheet. For estimating expenses, I have used some methods to estimate and manage my expenses. Let me know in the <a href="https://docs.google.com/forms/d/e/1FAIpQLScswYDxLhregN4xUfROgkLVpPJItCGwtvXNHUHqep_RTe5lrw/viewform?usp=sharing">feedback form</a> if this is something you’d like to see discussed in a future post!</li> </ul> <h2 id="what-next">What Next?</h2> <p>After tinkering with the spreadsheet and getting a sense of how much you need to save to support a certain amount of retirement spending, it’s time to refine those estimates. There’s much more to consider in a retirement plan than how much you want to save and when you want to retire.</p> <ul> <li>Other parts of a financial plan to consider <ul> <li>List down your dependents, and how much you will need to support them over time.</li> <li>Take stock of your liabilities (car/house/student loans, upcoming college fees for kids, ongoing medical costs).</li> <li>Consider your potential retirement costs. Below are some examples. <ul> <li>Long term care when you become less able</li> <li>Cost of moving to your retirement country of choice</li> <li>Moving house to be nearer to your children</li> <li>Rising healthcare costs in old age</li> </ul> </li> <li>Explore money management considerations towards and during retirement <ul> <li>How do you mitigate the risk of a market downturn shrinking your savings at the start of retirement, forcing a larger percentage withdrawal that then jeopardises your retirement (aka sequence of return risk)?</li> <li>What instruments will you use to generate your retirement income? Annuities? Dividends? Selling stocks and bonds? All of the above?</li> <li>Will you choose to use a cash buffer like I did here? Will you use a three year buffer or a larger or smaller buffer?</li> </ul> </li> </ul> </li> <li>Talk to your financial planner</li> <li>Consider trying <a href="https://www.upplan.sg/">UP</a> <ul> <li>They’ve built a web application with many more features than I have in my spreadsheet.</li> <li>It’s much more feature rich than my spreadsheet, and can handle many more events such as house and car loans, and various one-time and continuous expenses AND incomes.</li> <li>There is a really good tutorial-like wizard that helps guide you through the process in a step by step fashion. It’s really very helpful.</li> <li>UP has the capability to let you know when you run out of cash, or have too much savings, and advise you accordingly.</li> <li>Disclosure: I have worked with the company behind UP in the past, but have no financial interest or any other relationship with them at this time.</li> </ul> </li> </ul> <h2 id="thank-you">Thank you!</h2> <p>Thanks for reading! I hope you found it helpful and enjoyable.</p> <p>What would you like to hear more about next? Do let me know in the feedback form!</p>]]></content><author><name></name></author><category term="financial"/><category term="spreadsheets"/><summary type="html"><![CDATA[How the Savings Calculator came to be, and some key features]]></summary></entry><entry><title type="html">Hello World!</title><link href="https://ninjalemur.github.io/blog/2023/hello-world/" rel="alternate" type="text/html" title="Hello World!"/><published>2023-03-20T10:15:00+00:00</published><updated>2023-03-20T10:15:00+00:00</updated><id>https://ninjalemur.github.io/blog/2023/hello%20world</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2023/hello-world/"><![CDATA[<p>Welcome to my blog! I’m thrilled to share my thoughts with you and connect with like-minded people. Over the years, I have worked on a number of personal projects to tackle various challenges in life. In future posts, I will be sharing more about these projects and how they have helped me. I hope they help you too! I am excited to share them with you and would love to hear your feedback.</p> <p>Apart from my personal projects, I will be sharing my musings on various topics that interest me. From technology to cats, and everything in between, I’ll be sharing my personal thoughts and insights with you.</p> <p>Thanks for reading! Do subscribe if you wish to be notified about my latest posts!</p>]]></content><author><name></name></author><summary type="html"><![CDATA[Hello!]]></summary></entry><entry><title type="html">Displaying External Posts on Your al-folio Blog</title><link href="https://ninjalemur.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/" rel="alternate" type="text/html" title="Displaying External Posts on Your al-folio Blog"/><published>2022-04-23T23:20:09+00:00</published><updated>2022-04-23T23:20:09+00:00</updated><id>https://ninjalemur.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog</id><content type="html" xml:base="https://ninjalemur.github.io/blog/2022/displaying-external-posts-on-your-al-folio-blog/"><![CDATA[]]></content><author><name></name></author></entry></feed>